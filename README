ğŸ” Network Intrusion Detection System (NIDS) using Machine Learning

A production-oriented Network Intrusion Detection System (NIDS) built using unsupervised and supervised machine learning techniques on the CICIDS2017-18 dataset, with real-time packet capture and anomaly detection capabilities.

ğŸ“Œ Project Overview

This project implements a hybrid intrusion detection framework combining:

Isolation Forest (baseline unsupervised model)

Variational Autoencoder (VAE) for reconstruction-based anomaly detection

Random Forest (Multi-class) for attack-type classification

Live Packet Capture Engine using Scapy

Feature extraction based on 52 CIC flow-based network statistics

The system is designed to bridge academic research and real-world deployment, emphasizing low false alarm rates and production robustness.

ğŸ§  Dataset

Dataset: CICIDS2017-18

Total Samples: ~2.5 million network flows

Features: 52 flow-based statistical features

Binary Classification: Normal vs Attack

Multi-class Extension: DDoS, DoS, PortScan, Brute Force, Botnet, etc.

The dataset was preprocessed, normalized, and split into training and testing sets (80/20 split).

ğŸ— Project Structure
â”œâ”€â”€ Notebooks/
  â”œâ”€â”€ 01_data_exploration.ipynb
  â”œâ”€â”€ 02_data_preprocessing.ipynb
  â”œâ”€â”€ 03_baseline_isolation_forest.ipynb
  â”œâ”€â”€ 04_Random_Forest_multiclass.ipynb
  â”œâ”€â”€ 05_advanced_VAE.ipynb
  â”œâ”€â”€ 07_packet_capture_engine.ipynb
â”œâ”€â”€ data/
â”œâ”€â”€ models/
â”œâ”€â”€ results/

ğŸ“Š Model Implementations

1ï¸âƒ£ Isolation Forest (Baseline)

Unsupervised anomaly detection

100 trees

Contamination â‰ˆ 17%

Fast training and inference

Performance:

Accuracy: ~82â€“83%

Precision: ~48.6%

Recall: ~49%

False Alarm Rate: ~10.5%

Serves as statistical baseline.

2ï¸âƒ£ Variational Autoencoder (Advanced Anomaly Model)

Architecture:

52 â†’ 32 â†’ 16 â†’ 8 (Latent Space)
8 â†’ 16 â†’ 32 â†’ 52 (Reconstruction)


Loss: MSE + KL Divergence

Threshold: 90th percentile of normal reconstruction error

Trained only on normal traffic

Performance:

Accuracy: 90.17%

Precision: 85.29%

Recall: 50.51%

False Alarm Rate: 1.77%

~8â€“9% reduction in false alarms vs Isolation Forest

The VAE significantly improves precision and reduces alert noise.

3ï¸âƒ£ Random Forest (Multi-class)

Supervised multi-class attack classification

Used to identify specific attack types

Complements anomaly detection framework

âš™ï¸ Real-Time Packet Capture Engine

Implemented using Scapy:

Live packet sniffing

5-tuple bidirectional flow aggregation

Extraction of 52 CIC-based features

Real-time anomaly inference

Designed for ~90 packets/sec processing (CPU-only)

Includes safeguards:

NaN/Inf handling

Safe division logic

Fallback mechanisms

ğŸ“ˆ Key Insights

VAE reduces false alarm rate dramatically compared to Isolation Forest.

Reconstruction error provides strong separation between normal and attack flows.

Precision improvements are more significant than recall improvements.

False positive reduction is critical for SOC usability.

ğŸ›  Tech Stack

Python 3.13

TensorFlow / Keras

Scikit-learn

NumPy / Pandas

Matplotlib / Seaborn

Scapy

Jupyter Notebook

ğŸš€ How to Run

1ï¸âƒ£ Install Dependencies

pip install -r requirements.txt

2ï¸âƒ£ Workflow Order

Run 01_data_exploration.ipynb

Run 02_data_preprocessing.ipynb

Train baseline: 03_baseline_isolation_forest.ipynb

Train deep model: 05_advanced_VAE.ipynb

Optional: Multi-class 04_Random_Forest_multiclass.ipynb

Run real-time engine: 07_packet_capture_engine.ipynb

ğŸ“Œ Future Improvements

ROC/AUC and threshold sensitivity analysis

Adaptive dynamic thresholding

Model quantization (INT8) for faster inference

SIEM integration

Multi-dataset validation (UNSW-NB15, NSL-KDD)

ğŸ¯ Project Goal

To design a low-noise, production-oriented anomaly detection system that balances detection capability with operational practicality in real network environments.

ğŸ‘¨â€ğŸ’» Author

Final Year Computer Science Engineering Project
Focused on Cybersecurity, Anomaly Detection, and Real-Time Network Monitoring.
