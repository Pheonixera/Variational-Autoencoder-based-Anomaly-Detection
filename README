ğŸ›¡ï¸ Variational Autoencoder (VAE) Based Anomaly Detection IDS


ğŸ“Œ Project Overview

This project implements an Intrusion Detection System (IDS) using a Variational Autoencoder (VAE) for anomaly detection. The IDS identifies deviations in network traffic patterns and flags anomalous behavior, using the NSL-KDD dataset.

Access the SENTINEL website through this link: https://lovable.dev/projects/2dd16b21-fe18-4bcf-b28f-998098bc8979

NOTE:Frontend is done using Lovable.ai.

âš™ï¸ How It Works

ğŸ” Anomaly Detection Using VAE

â€¢	The Variational Autoencoder learns a compressed (latent) representation of normal network traffic patterns during training.

â€¢	During inference (testing), the VAE attempts to reconstruct the input data.

â€¢	Reconstruction Error (difference between input and output) is used as the anomaly score.

â€¢	If the reconstruction error exceeds a learned threshold, the instance is classified as anomalous.

ğŸ—‚ï¸ Project Files

Preprocess.py	Main script. Handles preprocessing, model training, and anomaly detection.
KDDTrain+_20Percent.arff	Training dataset (subset of NSL-KDD).
KDDTest+.arff		Testing dataset.
vae_model.pth	Saved model weights after training.
IDS_SRS report	General report on IDS (not specific to this project).

ğŸ§ª Model Details

ğŸ§  VAE Architecture

â€¢	Encoder: Fully connected layers to reduce dimensionality.

â€¢	Latent Space: Mean & log-variance layers.

â€¢	Decoder: Reconstructs input from latent representation.

â€¢	Activation: ReLU (encoder/decoder), Sigmoid (output layer).

ğŸ”¢ Loss Function

The VAE minimizes a combined loss:

â€¢	Reconstruction Loss: Measures how accurately the input is reconstructed (Mean Squared Error).

â€¢	KL Divergence: Encourages the latent space distribution to resemble a Gaussian.

vae_loss = MSELoss + KL_Divergence

ğŸ§¾ Anomaly Criteria

â€¢	Reconstruction Error (MSE) is calculated for each input.

â€¢	A threshold is computed (e.g., 95th percentile) on the training reconstruction errors.

â€¢	Any test input with reconstruction error above this threshold is marked as anomaly.

â–¶ï¸ How to Run

âœ… Prerequisites

Python 3.x

Install dependencies:

pip install torch pandas numpy scikit-learn scipy

ğŸš€ Execution Steps

ğŸ” First Run (Training):

â€¢	python Preprocess.py

â€¢	Loads and preprocesses KDDTrain+_20Percent.arff.

â€¢	Trains the VAE model.

â€¢	Saves the model to vae_model.pth.

ğŸ” Second Run (Testing):

â€¢	python Preprocess.py

â€¢	Loads the trained model.

â€¢	Preprocesses KDDTest+.arff.

â€¢	Tests data using VAE.

â€¢	Outputs anomalies based on reconstruction error and threshold.

ğŸ“¤ Sample Anomaly Output

timestamp: 2025-05-21T12:34:56.789000Z
src_ip: 192.168.1.100
dst_ip: 10.0.0.5
anomaly_type: Network Traffic Anomaly
severity: High
deviation_score: 23.56
description: Detected abnormal network pattern with reconstruction error 0.2356
action_taken: Logged for review
protocol: tcp

ğŸ§¼ Preprocessing Highlights

â€¢	ARFF File Cleaning: Fixes inconsistencies in categorical value syntax.

â€¢	Label Encoding: For categorical features (protocol_type, service, flag).

â€¢	Scaling: All numerical values scaled between 0 and 1 using MinMaxScaler.

â€¢	Binary Labeling: "normal" = 0, all other types = 1 (for testing accuracy).

ğŸ“ˆ Thresholding Strategy

â€¢	Threshold for anomalies is set at the 95th percentile of reconstruction errors from training data.

â€¢	This value is used during testing to distinguish normal vs anomalous inputs.

ğŸ§  Technologies Used

â€¢	Python

â€¢	PyTorch â€“ For building and training the VAE.

â€¢	scikit-learn â€“ Label encoding, scaling.

â€¢	pandas & numpy â€“ Data processing.

â€¢	scipy.io.arff â€“ Loading NSL-KDD dataset.

ğŸ“š Reference Dataset

â€¢	NSL-KDD Dataset

â€¢	KDDTrain+_20Percent.arff

â€¢	KDDTest+.arff

ğŸ” Note

The current setup uses static IP placeholders (src_ip, dst_ip). In a production environment, this would be dynamically extracted from live packet data.

âœ… Future Improvements

â€¢	Integrate with real-time packet capture tools (like scapy or tshark).

â€¢	Store anomaly logs in a database (e.g., MongoDB).

â€¢	Enable online learning to adapt the VAE model continuously.
